<!DOCTYPE html>
<html ng-app="practice">
<head>
  <title>Mean Stack Practice</title>
  <link rel="stylesheet" type="text/css" href="./libs/bootstrap/dist/css/bootstrap.css">

</head>
<body>
  <div class="container">
    <div ng-view></div>
  </div>

  <script src="./libs/jquery/dist/jquery.js"></script>
  <script src="./libs/bootstrap/dist/js/bootstrap.js"></script>
  <script src="./libs/angular/angular.js"></script>
  <script src="./libs/angular-route/angular-route.js"></script>
  <script type="text/javascript">
    angular.module('practice', ['ngRoute'])
    .config(['$routeProvider', function($routeProvider) {
      $routeProvider
      .when('/', {
        templateUrl: 'home.html',
        controller: 'HomeController'
      })
      .when('/signup', {
        templateUrl: 'signup.html',
        controller: 'SignupController'
      })
      .otherwise({
        redirectTo: '/'
      });
    }])

    .controller('HomeController', ['$scope', '$http', function($scope, $http) {
      $scope.login = function() {
        $http.put('/users/login', {username: $scope.username, password: $scope.password})
        .then(function() {
          alert('successfully signed in');
        }, function() { // NOT WORKING CORRECTLY
          alert('bad login credentials');
        });
      };
      function getQuotes() {
        $http.get('/quotes').then(function(response) {
          $scope.quotes = response.data;
        });
      }
      $scope.submitNewQuote = function() {
        $http.post('/insert', {newQuote: $scope.newQuoteText}).then(function() {
          $scope.newQuoteText = "";
          getQuotes();
        });
      };
      $scope.updateQuote = function() {
        $http.put('/update', {
          id: $scope.id,
          updatedQuote: $scope.updatedQuote
        }).then(function() {
          $scope.id = "";
          $scope.updatedQuote = "";
          getQuotes();
        });
      };
      $scope.deleteQuote = function(quote) {
        $http.put('/delete', {id: quote}).then(function() {
          $scope.id = "";
          getQuotes();
        });
      };
      getQuotes();
    }])

    .controller('SignupController', ['$scope', '$http', function($scope, $http) {
      $scope.submitSignup = function() {
        var newUser = {
          username: $scope.username,
          password: $scope.password
        };
        $http.post('/users', newUser).then(function() {
          alert('success');
        });
      };
   }]);
  </script>
</body>
</html>